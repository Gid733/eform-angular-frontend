<eform-subheader [title]="'Eform visual editor' | translate">
  <div class="p-3">
    <button
      mdbBtn
      class="btn-accent text-black-50 btn-icon"
      (click)="openTagsModal()"
      mdbTooltip="{{ 'Manage tags' | translate }}"
      mdbWavesEffect
    >
      <fa-icon icon="tags" [fixedWidth]="true" size="lg"></fa-icon>
    </button>
    <button
      mdbBtn
      class="btn-success btn-small-height"
      (click)="createVisualTemplate()"
      mdbTooltip="{{ 'Save' | translate }}"
      mdbWavesEffect
    >
      {{
      'Save' | translate
      }}
    </button>
  </div>
</eform-subheader>

<div class="container-fluid">
  <div class="row mb-2">
    <div class="col-lg-9 col-md-12 col-xs-12">
      <app-eform-visual-editor-header
        [visualEditorModel]="visualEditorTemplateModel"
      ></app-eform-visual-editor-header>
    </div>
  </div>
  <div class="row mb-2">
    <div class="col-lg-9 col-md-12 col-xs-12">
      <div class="card z-depth-3" style="width: 100%">
        <div class="card-body">
          <div class="row">
            <div class="col">
              <button
                mdbBtn
                id="initialItemCreateBtn"
                class="btn-success btn-small-height"
                (click)="onAddNewElement(1)"
              >
                {{ 'Add new item' | translate }}
              </button>
              <ng-container>
                <button
                  mdbBtn
                  class="btn-icon mb-2 float-right text-black-50"
                  mdbTooltip="{{ 'Expand all' | translate }}"
                  (click)="toggleCollapse()"
                  *ngIf="isItemsCollapsed"
                >
                  <fa-icon
                    icon="angle-double-right"
                    size="lg"
                    [fixedWidth]="true"
                  ></fa-icon>
                </button>

                <button
                  mdbBtn
                  class="btn-icon mb-2 float-right text-black-50"
                  mdbTooltip="{{ 'Collapse all' | translate }}"
                  (click)="toggleCollapse()"
                  *ngIf="!isItemsCollapsed"
                >
                  <fa-icon
                    icon="angle-double-down"
                    size="lg"
                    [fixedWidth]="true"
                  ></fa-icon>
                </button>
              </ng-container>
            </div>
          </div>
          <section
            dragula="ITEMS"
            id="editorElements"
            (dragulaModelChange)="dragulaPositionChanged($event)"
            [dragulaModel]="visualEditorTemplateModel.fields"
          >
            <app-eform-visual-editor-element
              *ngFor="let editorElement of visualEditorTemplateModel.fields"
              [editorElement]="editorElement"
              id="editorElement"
              (addNewElement)="onAddNewElement($event)"
              (deleteElement)="onDeleteElement($event)"
              [ngClass]="{ 'no-drag': !editorElement.collapsed }"
              (editorElementChanged)="onEditorElementChanged($event)"
            ></app-eform-visual-editor-element>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>

<app-eform-visual-editor-tags
  #tagsModal
  [availableTags]="availableTags"
  (tagsChanged)="getTags()"
>
</app-eform-visual-editor-tags>
