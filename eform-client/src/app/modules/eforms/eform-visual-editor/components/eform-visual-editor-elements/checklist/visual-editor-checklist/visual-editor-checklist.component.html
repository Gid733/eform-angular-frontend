<!-- Nested checklists level rendering -->
<section id="checkListSection{{ checklistIndex }}" *ngIf="checklist">
  <div class="card z-depth-3 mb-4 mt-4" style="width: 100%">
    <div class="card-header">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <fa-icon
            id="moveBtn"
            size="lg"
            icon="grip-lines"
            class="dragula-handle"
            [fixedWidth]="true"
            style="cursor: pointer"
          ></fa-icon>
          {{ 'Checklist' | translate }}
        </div>
        <div class="d-flex align-items-center">
          <fa-icon
            *ngIf="!isChecklistComplete"
            [mdbTooltip]="'eForm is not complete' | translate"
            icon="info-circle"
            [fixedWidth]="true"
            size="lg"
            class="text-warning mr-2"
          ></fa-icon>
          <button mdbBtn
                  [mdbTooltip]="'New nested checklist' | translate"
                  class="btn-success btn-icon"
                  id="addNewNestedChecklist{{ checklistIndex }}"
                  (click)="onAddNewNestedChecklist()"
          >
            <fa-icon icon="folder-plus" [fixedWidth]="true" size="lg"></fa-icon>
          </button>
          <button mdbBtn
                  [mdbTooltip]="'New nested field' | translate"
                  class="btn-success btn-icon"
                  id="addNewNestedField{{ checklistIndex }}"
                  (click)="onAddNewNestedField()"
          >
            <fa-icon icon="plus" [fixedWidth]="true" size="lg"></fa-icon>
          </button>
          <button mdbBtn
                  [mdbTooltip]="'Edit checklist' | translate"
                  class="btn-neutral btn-icon"
                  id="editChecklistBtn{{ checklistIndex }}"
                  (click)="onEditChecklist()"
          >
            <fa-icon icon="pen" [fixedWidth]="true" size="lg"></fa-icon>
          </button>
          <button mdbBtn
                  [mdbTooltip]="'Delete checklist' | translate"
                  class="btn-danger btn-icon"
                  id="deleteChecklistBtn{{ checklistIndex }}"
                  (click)="onDeleteChecklist()"
          >
            <fa-icon icon="trash-alt" [fixedWidth]="true" size="lg"></fa-icon>
          </button>
        </div>
      </div>
    </div>
    <div class="card-body">
      <div
        dragula="{{ dragulaElementContainerName }}"
        [dragulaModel]="checklist.fields"
        (dragulaModelChange)="onNestedFieldChanged($event)"
      >
        <ng-container *ngFor="let field of checklist.fields; let fieldIndex = index">
          <app-visual-editor-field
            [fieldIndex]="fieldIndex"
            [field]="field"
            (fieldPositionChanged)="onNestedFieldChanged($event)"
            (addNewField)="onAddNewNestedField()"
            (deleteField)="onDeleteNestedField(fieldIndex, field)"
            (editField)="onEditNestedField(fieldIndex, field)"
          ></app-visual-editor-field>
        </ng-container>
      </div>
    </div>
  </div>
</section>
<ng-container *ngIf="checklist && checklist.checkLists;">
  <app-visual-editor-checklist
    [checklist]="elem"
    [checklistRecursionIndex]="checklistRecursionIndex + 1"
    [checklistIndex]="checklistIndex + 1"
    [checklistRecursionIndexes]="composeIndexes"
    *ngFor="let elem of checklist.checkLists; let checklistIndex = index"
  ></app-visual-editor-checklist>
</ng-container>
