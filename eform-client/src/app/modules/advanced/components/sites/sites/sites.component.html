<eform-page-subheader [title]="'Sites' | translate">

</eform-page-subheader>

<!--Here you can choose approach as you like: container-row, or flex, or just element with required styles and markup-->
<div class="container-fluid">
  <div class="row p-1 table-responsive no-gutters">
    <table class="table table-sm table-striped text-center z-depth-1">
      <thead>
      <tr>
        <th scope="col">{{ 'Created at' | translate }}</th>
        <th scope="col"> {{ 'Updated at' | translate }}</th>
        <th scope="col">{{ 'Name' | translate }}</th>
        <th scope="col"> Microting UID</th>
        <th scope="col" *ngIf="userClaims.sitesDelete || userClaims.sitesUpdate">{{ 'Actions' | translate }}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let siteDto of sitesDto">
        <td id="siteId" scope="row">
          <date-formatter [date]="siteDto.createdAt" [Format]="'datetime'"></date-formatter>
        </td>
        <td>
          <date-formatter [date]="siteDto.updatedAt" [Format]="'datetime'"></date-formatter>
        </td>
        <td>{{siteDto.siteName}}</td>
        <td>
          {{siteDto.siteUId}}
        </td>
        <td>
          <div class="d-flex justify-content-center">
            <div>
              <a class="btn btn-sm btn-success p-1 mb-2"
                 id="editSiteTagsBtn"
                 mdbTooltip="{{ 'Edit tags' | translate }}" (click)="openEditTagsModal(siteDto)">
                {{ 'Edit tags' | translate }}
              </a>
              <p class="paragraph-sm" id="assignedTag" *ngFor="let tag of siteDto.tags">
                {{tag.value}}
              </p>
            </div>
          </div>
        </td>
        <td *ngIf="userClaims.sitesDelete || userClaims.sitesUpdate">
          <div class="d-flex flex-row justify-content-center">
            <button class="btn btn-accent text-black-50 btn-icon mb-2 " id="editSiteBtn" *ngIf="userClaims.sitesUpdate"
                    mdbTooltip="{{'Edit Site' | translate}}" mdbWavesEffect
                    (click)="openEditModal(siteDto)">
              <fa-icon icon="pen" [fixedWidth]="true" size="lg"></fa-icon>
            </button>
            <button class="btn btn-danger btn-icon mb-2 " id="deleteSiteBtn" *ngIf="userClaims.sitesDelete"
                    mdbTooltip="{{'Delete site' | translate}}"
                    (click)="openDeleteModal(siteDto)">
              <fa-icon icon="trash-alt" [fixedWidth]="true" size="lg"></fa-icon>
            </button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<eform-spinner [spinnerVisibility]="spinnerStatus"></eform-spinner>

<app-site-edit
  [siteNameDto]="selectedSiteDto"
  #modalSiteEdit></app-site-edit>
<app-site-delete
  (onSiteRemoved)="loadAllSites()"
  [siteNameDto]="selectedSiteDto"
  #modalSiteDelete></app-site-delete>
<app-site-tags (onSiteTagsUpdated)="loadAllSites()"
               (onTagAdded)="loadAllTags()"
               [availableTags]="availableTags"
               #modalSiteTags></app-site-tags>
